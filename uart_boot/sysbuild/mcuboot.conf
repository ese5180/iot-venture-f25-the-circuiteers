# STEP 2.3 - Enable logging for MCUboot
CONFIG_LOG=y
CONFIG_MCUBOOT_LOG_LEVEL_INF=y
CONFIG_LOG_MODE_IMMEDIATE=y

# MCUboot serial recovery configuration
CONFIG_MCUBOOT_SERIAL=y
CONFIG_BOOT_SERIAL_UART=y
# Disable UART console (required for serial recovery)
CONFIG_UART_CONSOLE=n

# Serial recovery settings from the article
CONFIG_BOOT_SERIAL_DETECT_DELAY=450
CONFIG_BOOT_SERIAL_NO_APPLICATION=y
CONFIG_BOOT_SERIAL_ENTRANCE_GPIO=y


# LED indication
CONFIG_MCUBOOT_INDICATION_LED=y

# GPIO for button detection
CONFIG_GPIO=y

# CRITICAL: Enable image swapping mechanism
CONFIG_BOOT_SWAP_USING_SCRATCH=y
# Alternative: CONFIG_BOOT_SWAP_USING_MOVE=y (if no scratch partition)

# ESSENTIAL: Disable upgrade-only mode to enable swapping
CONFIG_BOOT_UPGRADE_ONLY=n

# Enable basic MCUboot functionality
CONFIG_BOOT_BOOTSTRAP=n

# Enable image validation
CONFIG_BOOT_VALIDATE_SLOT0=y

# Enable swap status tracking
CONFIG_BOOT_MAX_IMG_SECTORS=128

# Enable swap state management
CONFIG_BOOT_SWAP_SAVE_ENCTLV=n

# Ensure proper flash operations
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y

# Fix the sector count dependency
CONFIG_BOOT_MAX_IMG_SECTORS_AUTO=n
